# 콘서트 예약 서비스

단순 API 목록은 다음 [링크](http://localhost:8080/swagger-ui/index.html)에서 확인할 수 있습니다.

외부 API는 카카오페이의 결제 API를 사용했습니다.

## 기능 목록

- 회원가입
    - 사용자는 회원가입할 수 있습니다.
- 로그인
    - 사용자는 이메일, 비밀번호를 통해 로그인하고, 토큰을 발급받아 쿠키에 저장합니다.
- 로그아웃 (회원)
    - 로그인 한 회원의 토큰을 만료시킵니다.

- 공연장 추가 (관리자)
    - 관리자는 공연장을 추가할 수 있습니다.
- 공연장 목록 조회 (회원)
    - 회원은 공연장 목록을 조회할 수 있습니다.
- 공연장 상세 조회 (회원)
    - 회원은 공연장의 상세 정보를 조회할 수 있습니다.

- 좌석 추가 (관리자)
    - 관리자는 좌석을 추가할 수 있습니다.
- 좌석 목록 조회 (관리자)
    - 괸리자는 전체 좌석 목록을 조회할 수 있습니다.
- 좌석 상세 조회 (회원)
    - 회원은 좌석의 상세 정보를 조회할 수 있습니다.
- 콘서트 좌석 조회 = 콘서트 예약 현황 (회원)
    - 회원은 콘서트의 예약 현황을 조회할 수 있습니다.

- 콘서트 추가 (관리자)
    - 관리자는 콘서트를 추가할 수 있습니다.
- 콘서트 목록 조회
    - 사용자는 콘서트 목록을 조회할 수 있습니다.
- 시작 전 콘서트 목록 조회
    - 사용자는 시작하지 않은 콘서트 목록을 조회할 수 있습니다.
- 콘서트 상세 조회
    - 사용자는 콘서트의 상세 정보를 조회할 수 있습니다.

- 콘서트 예약 준비 요청 = 결제 준비 (회원)
    - 회원은 콘서트 예약 시 결제를 위한 사전 정보를 전송합니다.
- 콘서트 예약 (회원)
    - 사용자는 콘서트를 예약할 수 있습니다.
    - 좌석을 선택하고 결제를 승인하여 예약합니다.
- 콘서트 예약 상세 정보 조회 (회원)
    - 사용자는 자신이 예약한 내역들의 세부 정보(콘서트, 날짜, 좌석, 결제 정보를 포함한)를 조회할 수 있습니다.
- 콘서트 예약 단건 정보 조회 (회원)
  - 사용자는 자신의 특정 예약 정보를 조회할 수 있습니다.
- 콘서트 예약 수정 = 좌석 변경 (회원)
    - 사용자는 자신의 예약에 대한 좌석을 변경할 수 있습니다.
        - 혹은 관리자가 다른 사용자의 예약에 대한 좌석을 변경할 수 있습니다.
- 콘서트 예약 취소 (회원)
    - 사용자는 자신의 예약을 취소할 수 있습니다.
        - 혹은 관리자가 다른 사용자의 에약을 취소할 수 있습니다.
    - 기존 결제 내역은 취소됩니다.
- 전체 콘서트 예약 정보 조회 (관리자)
  - 관리자는 전체 예약 내역을 조회할 수 있습니다.

## 특이사항

- 일반적으로 콘서트는 좌석 구역 별 차등 가격이 존재하지만, 이 서비스에서는 고려하지 않습니다.
- 예약 정보 수정은 좌석 변경만 가능합니다.
- 최종 미션의 특수성으로 인한 시간 부족으로 다음과 같은 부분은 본 서비스에서 고려하지 않겠습니다.
  - 예약 정보 삭제 시 예약 상태를 고려할 수 있겠지만 (예약, 취소 등) 단순히 처리하기 위해 예약 내역을 삭제합니다.
  - 예약 정보 삭제 시 결제 취소를 호출하지만, 결제 취소의 성공 여부와 관계 없이 결제가 정상적으로 취소되었다고 가정하고, 결제 내역을 삭제하겠습니다. 

## 초기 데이터 SQL

필요에 따라 다음 SQL문을 통해 초기 데이터를 삽입할 수 있습니다.

```
INSERT INTO venue (name, address) VALUES ('올림픽공원 KSPO 돔', '서울특별시 송파구 올림픽로 424');
INSERT INTO venue (name, address) VALUES ('고척 스카이돔', '서울특별시 구로구 경인로 430');
INSERT INTO venue (name, address) VALUES ('잠실실내체육관', '서울특별시 송파구 올림픽로 25');

INSERT INTO concert (title, artist, concert_date, venue_id, price, description) VALUES ('에스파 콘서트', '에스파', '2025-07-20 19:00:00', 1, 120000, '아이유의 2025년 단독 콘서트');
INSERT INTO concert (title, artist, concert_date, venue_id, price, description) VALUES ('BTS 월드 투어', 'BTS', '2025-08-15 18:00:00', 2, 150000, 'BTS의 글로벌 월드 투어의 서울 공연');
INSERT INTO concert (title, artist, concert_date, venue_id, price, description) VALUES ('임영웅 전국 투어', '임영웅', '2025-09-10 17:00:00', 3, 80000, '임영웅의 2025 전국 투어 서울 공연');

INSERT INTO seat (seat_number, venue_id) VALUES (11, 1);
INSERT INTO seat (seat_number, venue_id) VALUES (12, 1);
INSERT INTO seat (seat_number, venue_id) VALUES (21, 2);
INSERT INTO seat (seat_number, venue_id) VALUES (22, 2);
INSERT INTO seat (seat_number, venue_id) VALUES (31, 3);
INSERT INTO seat (seat_number, venue_id) VALUES (32, 3);

INSERT INTO member (name, email, password, role) VALUES ('시소', 'siso@gmail.com', '1234', 'MEMBER');
INSERT INTO member (name, email, password, role) VALUES ('솔라', 'solar@gmail.com', '1234', 'ADMIN');
```

## 도메인 개념

- 사용자(User) : 콘서트를 예약하는 사람
    - 이름
    - 이메일
    - 비밀번호
    - 역할
        - 일반 회원
        - 관리자
- 콘서트(Concert) : 콘서트
    - 제목
    - 아티스트
    - 공연일시(날짜 및 시간)
    - 장소
    - 가격
    - 설명
- 공연장(Venue) : 콘서트 장소
    - 이름
    - 주소
- 좌석(Seat) : 공연장에 존재하는 좌석
    - 좌석 번호
    - 공연장
- 예약(Reservation) : 사용자가 콘서트를 예약한 정보
    - 사용자
    - 콘서트
    - 좌석
- 결제 내역(Payment) : 예약에 대한 결제 정보
    - 예약
    - 결제 금액
    - 결제 ID (tid)
    - 결제 요청 일시
    - 결제 승인 일시
